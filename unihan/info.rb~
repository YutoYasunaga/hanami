DATA = {}
File.open('./unihan/Unihan_Readings.txt','r') do |io|
    io.each_line do |line|
        line.chomp!
        line.strip!
        next if line.empty? || line[0] == '#'
        data = line.split("\t")
        cp = data[0].match(/U\+([0-9A-F]{4})/)
        if cp
            cp = cp[1].to_i(16)
            DATA[cp] ||= {}
            DATA[cp][data[1]] = data[2]
        end
    end
end

File.open('./Unihan_Info','w') do |io|
    DATA.each_pair do |key,val|
        info = []
        info << val['kJapaneseOn']
        info << val['kJapaneseKun']
        info << val['kDefintion']
        info << val['kMandarin'] if info.empty?
        unless info.empty?
            io << key << "\t" << info.join('; ') << "\n"
        end
    end
end
